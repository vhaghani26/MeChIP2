rule call_peaks:
	input:
		"bam_files/{sample}.sorted.dedup.bam"
	output:
		"peaks/{sample}_model.r",
		"peaks/{sample}_peaks.xls",
		"peaks/{sample}_peaks.broadPeak",
		"peaks/{sample}_peaks.gappedPeak",
		"peaks/{sample}_treat_pileup.bdg",
		"peaks/{sample}_control_lambda.bdg"
	shell:
		"macs3 callpeak -t {input} CONTROL -f BAM -n {wildcards.sample} --bdg "
		"-g GENOME_SIZE --broad --outdir peaks/"
