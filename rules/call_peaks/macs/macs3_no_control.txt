#expand("peaks/{sample}_{control}_peaks.xls", sample=config["sample_groups"],
	#control=config["control_groups"])
	
def get_sample_groups(wildcards):
	if len(wildcards.sample.split('_')) == 1:
		return "bam_files/{sample}.sorted.dedup.bam"
	else:
		exp = wildcards.sample.split('_')
		return expand("bam_files/{sample}.sorted.dedup.bam", sample=exp)

rule call_peaks:
	input:
		s = get_sample_groups
	output:
		"macs3_peaks/{sample}_peaks.xls"
	run:
		if type(input.s) is snakemake.io.Namedlist:
			sample_input = ' '.join(input.s)
		else:
			sample_input = input.s
		shell("macs3 callpeak -t {sample_input} -f READ_TYPE -n {wildcards.sample} "
			"--bdg -g GENOME_SIZE --outdir macs3_peaks/ PEAK_TYPE")
